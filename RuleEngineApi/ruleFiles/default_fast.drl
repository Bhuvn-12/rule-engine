import com.svayam.RuleEngine.Records
import org.json.JSONObject;

dialect  "mvel"

global java.lang.String sjeDebit;
global java.lang.String sjeCredit;
global java.lang.String sal;
global java.lang.String ip;
global java.lang.String event_record;

global JSONObject source_event;

function int $##$svayam$##$getRandomNumber(int low,int high){
    java.util.Random r=new java.util.Random();

    return r.nextInt(high-low) + low;
}

function char $##$svayam$##$getRandomAlpha(){
    java.util.Random r=new java.util.Random();

    char[] alphas={'A','X','M'};

    return alphas[r.nextInt(alphas.length)];
}

function String $##$svayam$##$getFileCode(){
    java.util.Random r=new java.util.Random();

    java.lang.String[] file_codes={"00","01","02","03","04","05","06"};

    return file_codes[r.nextInt(file_codes.length)];
}

function String $##$svayam$##$getCustomerGroupingCode(String customer_segment){
    java.util.Random r=new java.util.Random();
    if(customer_segment.toLowerCase().equals("retail")){
        String arr[]={"1101", "1201", "1202"};
        return arr[r.nextInt(arr.length)];
    }else if(customer_segment.toLowerCase().equals("commercial")){
        String arr[]={ "3103", "3104", "3199"};
        return arr[r.nextInt(arr.length)];
        
    }else{
        String arr[]={ "2101", "2102"};
        return arr[r.nextInt(arr.length)];
    }
}


function String $##$svayam$##$getTransactionChannelCode(){
    java.util.Random r=new java.util.Random();
    String arr[]={"100110","100120","100130","100190","100210","100220","100230","100240","100250","100260"};

    return arr[r.nextInt(arr.length)];
}


function String $##$svayam$##$getFiscalYear(String ppd,String format){
		java.time.format.DateTimeFormatter f = java.time.format.DateTimeFormatter.ofPattern( format ) ;
		
		
		
		java.time.LocalDate ld = java.time.LocalDate.parse( ppd , f ) ;
		
		return String.valueOf(ld.getYear());
}
	
function String $##$svayam$##$getFiscalMonth(String ppd,String format){
    java.time.format.DateTimeFormatter f = java.time.format.DateTimeFormatter.ofPattern( format ) ;
    
    
    
    java.time.LocalDate ld = java.time.LocalDate.parse( ppd , f ) ;
    
    return String.valueOf(ld.getMonthValue());
}
	
function String $##$svayam$##$getFiscalPeriod(String ppd,String format){
    java.time.format.DateTimeFormatter f = java.time.format.DateTimeFormatter.ofPattern( format ) ;
    
    
    
    java.time.LocalDate ld = java.time.LocalDate.parse( ppd , f ) ;
    
    return String.valueOf(ld.getDayOfYear());
}

function String $##$svayam$##$getArrangementExtensionCode(){
    java.util.Random r=new java.util.Random();
    
    String extCode="EX"+(r.nextInt(8)+1);
    return extCode;
}


///////////////////
///Structure of source Event
///
// 1) For rules based on arrangement(SJE CREATION)-->
/////{arr_src_cd,arr_num,arr_suffix,amount,date,tgt_currency_cd,cust_industry_cd,dtl_cust_industry_cd,prod_cd,dtl_prod_cd,org_unit_cd,is_automated,event_name}
//
//2) For rules based on ip (ARRANGEMENT OR IP CREATION)
/////{ip_id,ip_name,country,country_residence_cd,zip_cd,party_type,party_dtl_type,occupation,arr_num,arr_suf,arr_src,prod_cd,dtl_prod_cd,org_unit_cd,date,starting_amt,isAutomated,event}
///
///////////////////




////////////////////////////////////////////
///////////
///////////RULE DEFINITIONS
///////////
////////////////////////////////////////////




//////////////////////////////////
/////////////////////////////////Credit card expense rule for Credit Card

rule "$##$svayam$##$-210101010-CREDIT CARD EXPENSE"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_210101010_credit_card_expense")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
            if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }
            
        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",5900600006"                                              /////////////acct_num
        sjeCredit+=",1211100003"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event


        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt


        record.setEventRecord(event_record);
        

end





//////////////////////////////////
/////////////////////////////////Accruel rule for FTE

rule "$##$svayam$##$-230207010-ACCRUEL"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_230207010_accruel")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
                sjeDebit+=",P";
            sjeCredit+=",P";

        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
            if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }
        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",5900600003"                                              /////////////acct_num
        sjeCredit+=",2281000004"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                             /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event


        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        
        record.setEventRecord(event_record);


end



//////////////////////////////////
/////////////////////////////////Payment rule for FTE

rule "$##$svayam$##$-230207010-PAYMENT"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_230207010_payment")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
                       if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }

        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",2281000004"                                              /////////////acct_num
        sjeCredit+=",1211100003"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event


        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        

        record.setEventRecord(event_record);






end



//////////////////////////////////
/////////////////////////////////Sale rule for Goods and Services of Account Recievable

rule "$##$svayam$##$-610101020-SALE"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_610101020_sale")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
                        if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }

        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",1211100004"                                              /////////////acct_num
        sjeCredit+=",4800000004"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event



        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        

        record.setEventRecord(event_record);




end




//////////////////////////////////
/////////////////////////////////Payment rule for Goods and Services of Account Recievable

rule "$##$svayam$##$-610101020-PAYMENT"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_610101020_payment")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
                       if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }

        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",1211100003"                                              /////////////acct_num
        sjeCredit+=",1211100004"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event



end




//////////////////////////////////
/////////////////////////////////Purchase rule for Goods and Services of Account Payable

rule "$##$svayam$##$-510101020-PURCHASE"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_510101020_purchase")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{           
             if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }

        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",5900600004"                                              /////////////acct_num
        sjeCredit+=",2281000005"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event



        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        

        record.setEventRecord(event_record);




end





//////////////////////////////////
/////////////////////////////////Make Payment rule for Goods and Services of Account Payable

rule "$##$svayam$##$-510101020-MAKE PAYMENT"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_510101020_make_payment")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
                       if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }

        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",2281000005"                                              /////////////acct_num
        sjeCredit+=",1211100003"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event




        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        

        record.setEventRecord(event_record);



end



//////////////////////////////////
/////////////////////////////////Deposit rule for Banking

rule "$##$svayam$##$-210105050-DEPOSIT"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_210105050_deposit")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
                        if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }

        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",1211100003"                                              /////////////acct_num
        sjeCredit+=",1211100005"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event



        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        

        record.setEventRecord(event_record);



end


//////////////////////////////////
/////////////////////////////////Withdrawl rule for Banking

rule "$##$svayam$##$-210105050-WITHDRAWL"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_210105050_withdrawl")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
                sjeDebit+=",P";
            sjeCredit+=",P";

        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
            if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }
        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",1211100005"                                              /////////////acct_num
        sjeCredit+=",1211100003"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event




        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        

        record.setEventRecord(event_record);



end



//////////////////////////////////
/////////////////////////////////Interest rule for Banking

rule "$##$svayam$##$-210105050-INTEREST"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_210105050_interest")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
                        if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }

        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",5900600005"                                              /////////////acct_num
        sjeCredit+=",1211100003"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event



        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        

        record.setEventRecord(event_record);



end



//////////////////////////////////
/////////////////////////////////Fee rule for Banking

rule "$##$svayam$##$-210105050-FEE"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_210105050_fee")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
                        if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }

        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",5900600005"                                              /////////////acct_num
        sjeCredit+=",1211100003"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event



        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        

        record.setEventRecord(event_record);



end



//////////////////////////////////
/////////////////////////////////Withdrawl rule for Credit Card

rule "$##$svayam$##$-210101010-WITHDRAWL"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_210101010_withdrawl")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
                        if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }

        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",5900600006"                                              /////////////acct_num
        sjeCredit+=",1211100003"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event



        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        

        record.setEventRecord(event_record);




end



//////////////////////////////////
/////////////////////////////////Fee rule for Credit Card

rule "$##$svayam$##$-210101010-FEE"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_210101010_fee")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
                        if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }

        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",1211100003"                                              /////////////acct_num
        sjeCredit+=",2281000006"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event




        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        

        record.setEventRecord(event_record);



end



//////////////////////////////////
/////////////////////////////////Payment rule for Credit Card

rule "$##$svayam$##$-210101010-PAYMENT"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_210101010_payment")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
                        if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }

        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",1211100003"                                              /////////////acct_num
        sjeCredit+=",2281000006"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event



        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        

        record.setEventRecord(event_record);




end



//////////////////////////////////
/////////////////////////////////Disburse rule for Loan

rule "$##$svayam$##$-210101040-DISBURSE"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_210101040_disburse")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
                        if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }

        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",1211100003"                                              /////////////acct_num
        sjeCredit+=",2281000007"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event



        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        

        record.setEventRecord(event_record);



end



//////////////////////////////////
/////////////////////////////////Interest rule for Loan

rule "$##$svayam$##$-210101040-INTEREST"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_210101040_interest")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
                        if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }

        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",1211100003"                                              /////////////acct_num
        sjeCredit+=",2281000007"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event



        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        

        record.setEventRecord(event_record);



end



//////////////////////////////////
/////////////////////////////////Payment rule for Loan

rule "$##$svayam$##$-210101040-PAYMENT"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_210101040_payment")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
                        if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }

        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",2281000007"                                              /////////////acct_num
        sjeCredit+=",1211100003"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event




        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        

        record.setEventRecord(event_record);



end



//////////////////////////////////
/////////////////////////////////Buy Shares rule for Equity

rule "$##$svayam$##$-210201010-BUY SHARES"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_210201010_buy_shares")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
                        if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }

        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",1211100003"                                              /////////////acct_num
        sjeCredit+=",3900000002"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event



        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        

        record.setEventRecord(event_record);



end



//////////////////////////////////
/////////////////////////////////Sell shre rule for Equity

rule "$##$svayam$##$-210201010-SELL SHARE"

    when 

        record :Records(record.getRuleCode()=="$##$svayam$##$_210201010_sell_share")         /////////event code is combination of detail product code and event name in lowercase

    then

        /////////////
        //obtaining source event

        source_event=record.getSourceEvent();                             ///////////source_event is a json object

        
        

        ///////////////
        //creating sje

        

        sjeDebit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        sjeCredit=source_event.getString("arr_src_cd")                                        ////////arr_src_cd
        
        sjeDebit+=","+source_event.getString("arr_num")                                    ////////arr_num
        sjeCredit+=","+source_event.getString("arr_num")                                    ////////arr_num

        sjeDebit+=","+source_event.getString("arr_suf")                                    ////////arr_suf
        sjeCredit+=","+source_event.getString("arr_suf")                                    ////////arr_suf

        sjeDebit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd
        sjeCredit+=","+source_event.getString("org_unit_cd")                                   ////////org_unit_cd

        sjeDebit+=","+source_event.getString("prod_cd")                                    ////////prod_cd
        sjeCredit+=","+source_event.getString("prod_cd")                                   ////////prod_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,2)+source_event.getString("arr_src_cd").substring(0,2)+$##$svayam$##$getRandomNumber(1,10)+$##$svayam$##$getRandomAlpha()                 ////////ldgr_src_cd

        sjeDebit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd
        sjeCredit+=","+$##$svayam$##$getFileCode()                                      ////////file_cd

        sjeDebit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd
        sjeCredit+=","+source_event.getString("prod_cd").substring(0,3)                     ////////file_subldgr_cd

        sjeDebit+=",FIN"                                                 ////////jrnl_type_cd
        sjeCredit+=",FIN"                                                 ////////jrnl_type_cd

        sjeDebit+=",ARE"                                                 ////////tech_comp_cd
        sjeCredit+=",ARE"                                                 ////////tech_comp_cd

        sjeDebit+=",Y"                                                   ////////arr_ind
        sjeCredit+=",Y"                                                   ////////arr_ind

        sjeDebit+=",N"                                                   ////////adj_cd
        sjeCredit+=",N"                                                   ////////adj_cd

        sjeDebit+=",RA"                                                   ////////int_file_cd
        sjeCredit+=",RA"                                                   ////////int_file_cd
                 
        ///////////jrnl_entry_type_cd
        if (source_event.getBoolean("is_automated")) {                
               sjeDebit+=",A";
               sjeCredit+=",A";
        }else{
            sjeDebit+=",P";
            sjeCredit+=",P";
        }

        sjeDebit+=","                                                     ///////////alt_org_unit_cd
        sjeCredit+=","                                                     ///////////alt_org_unit_cd

        ///////////partner_org_unit_cd
        if(!source_event.getBoolean("is_automated")){
            sjeDebit+="," ;                                                   
            sjeCredit+=",";
        }else{
                        if(record.isIueEligible(source_event.getString("org_unit_cd"))){

                sjeDebit+=","+source_event.getString("org_unit_cd");
                sjeCredit+=","+source_event.getString("org_unit_cd");
            }else{
                sjeDebit+="," ;                                                   
                sjeCredit+=",";
            }

        }

        sjeDebit+=","+source_event.getString("cust_industry_cd")                                    ///////////cust_industry_cd
        sjeCredit+=","+source_event.getString("cust_industry_cd")                                   ///////////cust_industry_cd
        
        sjeDebit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd
        sjeCredit+=","+source_event.getString("dtl_prod_cd")                                     ///////////dtl_prod_cd

        sjeDebit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd
        sjeCredit+=","+source_event.getString("dtl_cust_industry_cd")                                     ///////////dtl_cust_industry_cd

        sjeDebit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd
        sjeCredit+=","+$##$svayam$##$getCustomerGroupingCode(record.getCustomerSegment(source_event.getString("org_unit_cd"),source_event.getString("dtl_cust_industry_cd")))                   //////////cust_grouping_cd

        sjeDebit+=",IFRS"                                                 ////////////book_cd
        sjeCredit+=",IFRS"                                                 ////////////book_cd

        sjeDebit+=",ACTUAL"                                                 ////////////ldgr_type_cd
        sjeCredit+=",ACTUAL"                                                 ////////////ldgr_type_cd

        sjeDebit+=",3900000002"                                              /////////////acct_num
        sjeCredit+=",1211100003"                                              /////////////acct_num

        sjeDebit+=","                                              /////////////lcl_acct_num
        sjeCredit+=","                                              /////////////lcl_acct_num

        sjeDebit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd
        sjeCredit+=","+$##$svayam$##$getTransactionChannelCode()                               /////////////txn_chnl_cd

        sjeDebit+=","                                              /////////////ref_org_unit_cd
        sjeCredit+=","                                              /////////////ref_org_unit_cd

        sjeDebit+=","                                              /////////////ref_acct_num
        sjeCredit+=","                                              /////////////ref_acct_num

        sjeDebit+=","+record.getEventCode()                                              /////////////prod_event_cd
        sjeCredit+=","+record.getEventCode()                                              /////////////prod_event_cd

        sjeDebit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd
        sjeCredit+=","+record.getSourceCurrency(source_event.getString("org_unit_cd"))                                              /////////////src_curr_cd

        sjeDebit+=",TX"                                              /////////////src_curr_type_cd
        sjeCredit+=",TX"                                              /////////////src_curr_type_cd

        sjeDebit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd
        sjeCredit+=","+source_event.getString("tgt_curr_cd")                                              /////////////tgt_curr_cd

        sjeDebit+=",TX"                                              /////////////tgt_curr_type_cd
        sjeCredit+=",TX"                                              /////////////tgt_curr_type_cd

        sjeDebit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_year
        sjeCredit+=","+$##$svayam$##$getFiscalYear(record.getPpd(),"yyyy-MM-dd")                                             /////////////fiscal_year

        sjeDebit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month
        sjeCredit+=","+$##$svayam$##$getFiscalMonth(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_month

        sjeDebit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period
        sjeCredit+=","+$##$svayam$##$getFiscalPeriod(record.getPpd(),"yyyy-MM-dd")                                              /////////////fiscal_period

        sjeDebit+=","+source_event.getString("date")                                              /////////////acct_dt
        sjeCredit+=","+source_event.getString("date")                                              /////////////acct_dt

        sjeDebit+=","                                              /////////////orig_acct_dt
        sjeCredit+=","                                              /////////////orig_acct_dt

        sjeDebit+=","+record.getPpd();                                              /////////////ppd
        sjeCredit+=","+record.getPpd();                                              /////////////ppd

        sjeDebit+=","+record.getPpd();                                              /////////////wod
        sjeCredit+=","+record.getPpd();                                              /////////////wod

        sjeDebit+=",DB"                                              /////////////db_cr_ind
        sjeCredit+=",CR"                                              /////////////db_cr_ind

        sjeDebit+=",MVT"                                              /////////////txn_amt_type_cd
        sjeCredit+=",MVT"                                              /////////////txn_amt_type_cd

        sjeDebit+=","+(Double.parseDouble(source_event.getString("amount")) *-1)                                              /////////////txn_amt
        sjeCredit+=","+source_event.getString("amount")                                              /////////////txn_amt

        sjeDebit+=","                                              /////////////txn_conv_rate
        sjeCredit+=","                                              /////////////txn_conv_rate

        sjeDebit+=","                                              /////////////txn_conv_ind
        sjeCredit+=","                                              /////////////txn_conv_ind

        sjeDebit+=",Source System Journal"                                              /////////////jrnl_line_desc
        sjeCredit+=",Source System Journal"                                              /////////////jrnl_line_desc

        sjeDebit+=","                                              /////////////match_ref_num
        sjeCredit+=","                                              /////////////match_ref_num

        sjeDebit+=","                                              /////////////ldgr_recon_id
        sjeCredit+=","                                              /////////////ldgr_recon_id

        sjeDebit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key
        sjeCredit+=","+source_event.getString("src_trace_key")                                              /////////////src_trace_key

        sjeDebit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id
        sjeCredit+=","+record.getJournalDetailId("jrnl_dtl_id",source_event.getString("org_unit_cd"))                                              /////////////jrnl_dtl_id

        sjeDebit+=","                                              /////////////jrnl_ext_id
        sjeCredit+=","                                              /////////////jrnl_ext_id

        sjeDebit+=","                                              /////////////jrnl_id
        sjeCredit+=","                                              /////////////jrnl_id

        sjeDebit+=","                                              /////////////jrnl_line_id
        sjeCredit+=","                                              /////////////jrnl_line_id

        sjeDebit+=",FNC"                                              /////////////jrnl_parent_type_cd
        sjeCredit+=",FNC"                                              /////////////jrnl_parent_type_cd

        sjeDebit+=","                                              /////////////jrnl_parent_key
        sjeCredit+=","                                              /////////////jrnl_parent_key

        sjeDebit+=",ACC"                                              /////////////bus_func_cd
        sjeCredit+=",ACC"                                              /////////////bus_func_cd


        
        record.putSjes(sjeDebit)
        record.putSjes(sjeCredit)


        ////////////////////////////
        /////Creating standard event



        event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
        event_record+=","+record.getEventCode();                            ////////////event_cd
        event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
        event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
        event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
        event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
        event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
        event_record+=",";                            ////////////name
        event_record+=",";                            ////////////address
        event_record+=",";                            ////////////country
        event_record+=",";                            ////////////other_dtl
        event_record+=","+source_event.getString("amount");                            ////////////amount
        event_record+=","                            ////////////quantity
        event_record+=","+record.getPpd();                            ////////////event_dt
        

        record.setEventRecord(event_record);



end






//////////////////////////////////
/////////////////////////////////Hire rule for ent_cd


rule "$##$svayam$##$-230207010-HIRE"

when
    record:Records(record.getRuleCode()=="$##$svayam$##$_230207010_hire")
then
    

    /////////////
    //obtaining source event

    source_event=record.getSourceEvent();                             ///////////source_event is a json object

    
    ///////////////
    //creating arrangement record

    sal=source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf")           ////////arr_id
    sal+=","+source_event.getString("arr_src_cd")                                       /////////////arr_src_cd
    sal+=","+source_event.getString("arr_num")                                       /////////////arr_num
    sal+=","+source_event.getString("arr_suf")                                       /////////////arr_suf
    sal+=","+$##$svayam$##$getArrangementExtensionCode()                                       /////////////arr_ext_code
    sal+=","+source_event.getString("date")                                       /////////////edt
    sal+=","+record.getPpd()                                       /////////////wod
    sal+=","+record.getPpd()                                       /////////////ppd
    sal+=",SVYAM"                                               /////////////ppd
    sal+=","+source_event.getString("org_unit_cd")                                       /////////////org_unit_cd
    sal+=","+source_event.getString("date")                                       /////////////active_dt
    sal+=","                                                                /////////////inactive_dt
    sal+=","                                                                /////////////arr_src_internal_num
    sal+=","                                                                /////////////primary_ind
    
    sal+=",ACT"                                                                /////////////status_cd
    sal+=","                                                                /////////////isda_cd
    sal+=","                                                                /////////////acct_treatment_cd
    sal+=","                                                                /////////////orig_chnl_cd
    sal+=","                                                                /////////////booking_alt_org_unit_cd
    sal+=","+source_event.getString("dtl_prod_cd")                                                                /////////////dtl_prod_cd
    sal+=","                           ////////////interest_bearing_ind
    sal+=","                           ////////////int_only_ind
    sal+=","                           ////////////int_pay_schdl_ind
    sal+=","                           ////////////int_pay_dt_first
    sal+=","                           ////////////int_pay_dt_prev
    sal+=","                           ////////////int_pay_dt_next
    sal+=","                           ////////////int_pay_dt_final
    sal+=","                           ////////////int_pay_amt_cur
    sal+=","                           ////////////int_pay_curr_cd
    sal+=","                           ////////////int_pay_stub_date_start
    sal+=","                           ////////////int_pay_stub_date_end
    sal+=","                           ////////////int_pay_stub_type_cd
    sal+=","                           ////////////int_pay_unit_num
    sal+=","                           ////////////int_pay_unit_cd
    sal+=","                           ////////////int_pay_time_cd
    sal+=","                           ////////////int_rate_sched_ind
    sal+=","                           ////////////crnt_grs_int_rt
    sal+=","                           ////////////svcing_margin_rate
    sal+=","                           ////////////net_margin_rate
    sal+=","                           ////////////net_int_rate
    sal+=","                           ////////////var_rate_ind
    sal+=","                           ////////////inductory_inst_rate
    sal+=","                           ////////////indctry_inst_rate_ex_date
    sal+=","                           ////////////grs_inst_rt_rep_schdl_indt
    sal+=","                           ////////////grs_inst_fst_recc_rep_dt
    sal+=","                           ////////////grs_inst_final_rec_rep_dt
    sal+=","                           ////////////grs_inst_prvs_rec_rep_dt
    sal+=","                           ////////////grs_inst_nxt_rec_rep_dt
    sal+=","                           ////////////grs_inst_rep_prd_num_of_unit
    sal+=","                           ////////////grs_inst_rate_rep_uom_code
    sal+=","                           ////////////rep_ref_rt_crr_cd
    sal+=","                           ////////////rep_ref_rt_trm_num_of_unit
    sal+=","                           ////////////rep_ref_rt_trm_uom_cd
    sal+=","                           ////////////rep_ref_rt_curr_cd
    sal+=","                           ////////////grs_inst_rt_rep_sprd_rt
    sal+=","                           ////////////grs_inst_rt_indc_rep_sprd_rt
    sal+=","                           ////////////grs_inst_rt__indc_rep_sprd_rt_ex_dt
    sal+=","                           ////////////cap_rt_schdl_indt
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_cap_rt
    sal+=","                           ////////////grs_inst_rt_ind_abs_cap_rt
    sal+=","                           ////////////grs_inst_rt_ind_abs_cap_rt_ex_dt
    sal+=","                           ////////////floor_rt_schdl_indt
    sal+=","                           ////////////grs_inst_rt_abs_floor_rt_rep_life_floor_rt
    sal+=","                           ////////////grs_inst_indt_abs_floor_rt
    sal+=","                           ////////////grs_inst_indt_abs_floor_rt_ex_dt
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_cap_rt1
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_floor_rt
    sal+=","                           ////////////int_compound_num
    sal+=","                           ////////////int_compound_unit
    sal+=","                           ////////////int_accrual_cd
    sal+=","                           ////////////orig_int_rate
    sal+=","                           ////////////int_rate_type_cd
    sal+=","                           ////////////non_accrual_ind
    sal+=","                           ////////////overdue_ind
    sal+=","                           ////////////overdue_arr_date
    sal+=","                           ////////////overdue_num_of_acc_in_area
    sal+=","                           ////////////amt_in_area
    sal+=","                           ////////////amt_in_area_crr_cd
    sal+=","                           ////////////renegotiated_ind
    sal+=","                           ////////////arr_org_cont_mat_dt
    sal+=","                           ////////////regen_arr_dt
    sal+=","                           ////////////reconst_arr_indt
    sal+=","                           ////////////fixed_term_ind
    sal+=","                           ////////////fxd_term_mat_dt
    sal+=","                           ////////////original_cont_term_arr_num
    sal+=","                           ////////////original_cont_term_uom_cd
    sal+=","                           ////////////early_red_rapaymt_prl_amt
    sal+=","                           ////////////early_red_rapaymt_prl_amt_crr_cd
    sal+=","                           ////////////pay_on_demand_ind
    sal+=","                           ////////////notice_per_num
    sal+=","                           ////////////notice_per_cd
    sal+=","                           ////////////installment_ind
    sal+=","                           ////////////instalment_paymt_schedl_indicator
    sal+=","                           ////////////first_recc_instalment_paymt_dt
    sal+=","                           ////////////final_recc_instalment_paymt_dt
    sal+=","                           ////////////prevs_instalment_paymt_dt
    sal+=","                           ////////////next_instalment_paymt_dt
    sal+=","                           ////////////inst_num_of_uom_unit
    sal+=","                           ////////////inst_paymt_uom_cd
    sal+=","                           ////////////inst_paymt_amount
    sal+=","                           ////////////crnt_inst_paymt_amt_crr_cd
    sal+=","                           ////////////inst_paymt_min_per
    sal+=","                           ////////////inst_paymt_cal_method_cd
    sal+=","                           ////////////inst_paymt_timming_cd
    sal+=","                           ////////////inst_paymt_baloon_indt
    sal+=","                           ////////////var_inst_arr_indt
    sal+=","                           ////////////inst_paymt_change_schdl_indt
    sal+=","                           ////////////indct_paymt_change_life_cap_rt
    sal+=","                           ////////////indct_paymt_change_life_cap_rt_exp_dt
    sal+=","                           ////////////indct_paymt_change_life_floor_rt
    sal+=","                           ////////////indct_paymt_change_life_floor_rt_exp_dt
    sal+=","                           ////////////first_recc_paymt_change_dt
    sal+=","                           ////////////final_recc_paymt_change_dt
    sal+=","                           ////////////next_recc_paymt_change_dt
    sal+=","                           ////////////prvs_recc_paymt_change_dt
    sal+=","                           ////////////paymt_change_num_of_units
    sal+=","                           ////////////paymt_change_uom_cd
    sal+=","                           ////////////paymt_percentage_change_life_cap_rt
    sal+=","                           ////////////paymt_percentage_change_fl_cap_rt
    sal+=","                           ////////////paymt_change_prd_per_cap_rt
    sal+=","                           ////////////paymt_change_prd_per_flr_rt
    sal+=","                           ////////////src_fund_ind
    sal+=","                           ////////////fund_rt_indtsrc_sys_cd
    sal+=","                           ////////////fund_rt_effective_dt
    sal+=","                           ////////////funding_ref_num
    sal+=","                           ////////////current_funding_rt
    sal+=","                           ////////////funding_accural_basic_cd
    sal+=","                           ////////////rollover_ind
    sal+=","                           ////////////prvs_rollover_dt
    sal+=","                           ////////////next_rollover_dt
    sal+=","                           ////////////first_funding_amt
    sal+=","                           ////////////first_funding_amt_crr_cd
    sal+=","+source_event.getString("residence_country_cd")                           ////////////country_altimate_risk_cd
    sal+=","                           ////////////trade_ind
    sal+=","                           ////////////strct_trade_arr_indt
    sal+=","                           ////////////strct_trade_drived_cd
    sal+=","                           ////////////strct_trade_drived_acc_national_cd
    sal+=","                           ////////////hyrd_strct_trade_drived_arr_indt
    sal+=","                           ////////////trade_component_ind
    sal+=","                           ////////////lead_trade_arr_indt
    sal+=","                           ////////////netting_component_ind
    sal+=","                           ////////////red_linking_acc_type
    sal+=","                           ////////////red_linking_grp_cd
    sal+=","                           ////////////legal_right_set_of_indt
    sal+=","                           ////////////agg_agr_ind
    sal+=","                           ////////////agg_arr_count
    sal+=","+source_event.getString("ip_rec_id")                           ////////////ip_local_ref_num
    sal+=","+source_event.getString("residence_country_cd")                           ////////////ip_src_sys_cd
    sal+=","+source_event.getString("prod_cd")                           ////////////product_chf

    
    record.setSal(sal);



    ///////////////
    //creating Involved Party record


    ip=source_event.getString("ip_rec_id");                            //////////////ip_rec_id
    ip+=","+record.getPpd();                            //////////////eff_dt
    ip+=",SVYAM";                            //////////////src_trace_key
    ip+=","+source_event.getString("org_unit_cd");                            //////////////org_unit_cd
    ip+=","+source_event.getString("name");                            //////////////ip_name
    ip+=","+source_event.getString("city");                            //////////////ip_city_name
    ip+=","+source_event.getString("country");                            //////////////ip_country
    ip+=","+source_event.getString("zip");                            //////////////zip_cd
    ip+=","+source_event.getString("residence_country_cd");                            //////////////ip_residence_cd
    ip+=","+source_event.getString("cust_industry_cd");                            //////////////ip_cust_type_cd
    ip+=","+source_event.getString("dtl_cust_industry_cd");                            //////////////ip_dtl_cust_type_cd
    ip+=","+source_event.getString("occupation");                            //////////////occupation


    record.setInvolvedParty(ip);
    


    ////////////////////////////
    /////Creating standard event



    event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
    event_record+=","+record.getEventCode();                            ////////////event_cd
    event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
    event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
    event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
    event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
    event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
    event_record+=","+source_event.getString("name");                            ////////////name
    event_record+=","+source_event.getString("city")+"-"+source_event.getString("zip");                            ////////////address
    event_record+=","+source_event.getString("country");                            ////////////country
    event_record+=",";                            ////////////other_dtl
    event_record+=","+source_event.getString("starting_amount");                            ////////////amount
    event_record+=","                            ////////////quantity
    event_record+=","+record.getPpd();                            ////////////event_dt
    

    record.setEventRecord(event_record);

    

end



//////////////////////////////////
/////////////////////////////////Contract rule for ent_cd


rule "$##$svayam$##$-610101020-CONTRACT"

when
    record:Records(record.getRuleCode()=="$##$svayam$##$_610101020_contract")
then
    

    /////////////
    //obtaining source event

    source_event=record.getSourceEvent();                             ///////////source_event is a json object

    
    ///////////////
    //creating arrangement record

    sal=source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf")           ////////arr_id
    sal+=","+source_event.getString("arr_src_cd")                                       /////////////arr_src_cd
    sal+=","+source_event.getString("arr_num")                                       /////////////arr_num
    sal+=","+source_event.getString("arr_suf")                                       /////////////arr_suf
    sal+=","+$##$svayam$##$getArrangementExtensionCode()                                       /////////////arr_ext_code
    sal+=","+source_event.getString("date")                                       /////////////edt
    sal+=","+record.getPpd()                                       /////////////wod
    sal+=","+record.getPpd()                                       /////////////ppd
    sal+=",SVYAM"                                               /////////////ppd
    sal+=","+source_event.getString("org_unit_cd")                                       /////////////org_unit_cd
    sal+=","+source_event.getString("date")                                       /////////////active_dt
    sal+=","                                                                /////////////inactive_dt
    sal+=","                                                                /////////////arr_src_internal_num
    sal+=","                                                                /////////////primary_ind
    
    sal+=",ACT"                                                                /////////////status_cd
    sal+=","                                                                /////////////isda_cd
    sal+=","                                                                /////////////acct_treatment_cd
    sal+=","                                                                /////////////orig_chnl_cd
    sal+=","                                                                /////////////booking_alt_org_unit_cd
    sal+=","+source_event.getString("dtl_prod_cd")                                                                /////////////dtl_prod_cd
    sal+=","                           ////////////interest_bearing_ind
    sal+=","                           ////////////int_only_ind
    sal+=","                           ////////////int_pay_schdl_ind
    sal+=","                           ////////////int_pay_dt_first
    sal+=","                           ////////////int_pay_dt_prev
    sal+=","                           ////////////int_pay_dt_next
    sal+=","                           ////////////int_pay_dt_final
    sal+=","                           ////////////int_pay_amt_cur
    sal+=","                           ////////////int_pay_curr_cd
    sal+=","                           ////////////int_pay_stub_date_start
    sal+=","                           ////////////int_pay_stub_date_end
    sal+=","                           ////////////int_pay_stub_type_cd
    sal+=","                           ////////////int_pay_unit_num
    sal+=","                           ////////////int_pay_unit_cd
    sal+=","                           ////////////int_pay_time_cd
    sal+=","                           ////////////int_rate_sched_ind
    sal+=","                           ////////////crnt_grs_int_rt
    sal+=","                           ////////////svcing_margin_rate
    sal+=","                           ////////////net_margin_rate
    sal+=","                           ////////////net_int_rate
    sal+=","                           ////////////var_rate_ind
    sal+=","                           ////////////inductory_inst_rate
    sal+=","                           ////////////indctry_inst_rate_ex_date
    sal+=","                           ////////////grs_inst_rt_rep_schdl_indt
    sal+=","                           ////////////grs_inst_fst_recc_rep_dt
    sal+=","                           ////////////grs_inst_final_rec_rep_dt
    sal+=","                           ////////////grs_inst_prvs_rec_rep_dt
    sal+=","                           ////////////grs_inst_nxt_rec_rep_dt
    sal+=","                           ////////////grs_inst_rep_prd_num_of_unit
    sal+=","                           ////////////grs_inst_rate_rep_uom_code
    sal+=","                           ////////////rep_ref_rt_crr_cd
    sal+=","                           ////////////rep_ref_rt_trm_num_of_unit
    sal+=","                           ////////////rep_ref_rt_trm_uom_cd
    sal+=","                           ////////////rep_ref_rt_curr_cd
    sal+=","                           ////////////grs_inst_rt_rep_sprd_rt
    sal+=","                           ////////////grs_inst_rt_indc_rep_sprd_rt
    sal+=","                           ////////////grs_inst_rt__indc_rep_sprd_rt_ex_dt
    sal+=","                           ////////////cap_rt_schdl_indt
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_cap_rt
    sal+=","                           ////////////grs_inst_rt_ind_abs_cap_rt
    sal+=","                           ////////////grs_inst_rt_ind_abs_cap_rt_ex_dt
    sal+=","                           ////////////floor_rt_schdl_indt
    sal+=","                           ////////////grs_inst_rt_abs_floor_rt_rep_life_floor_rt
    sal+=","                           ////////////grs_inst_indt_abs_floor_rt
    sal+=","                           ////////////grs_inst_indt_abs_floor_rt_ex_dt
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_cap_rt1
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_floor_rt
    sal+=","                           ////////////int_compound_num
    sal+=","                           ////////////int_compound_unit
    sal+=","                           ////////////int_accrual_cd
    sal+=","                           ////////////orig_int_rate
    sal+=","                           ////////////int_rate_type_cd
    sal+=","                           ////////////non_accrual_ind
    sal+=","                           ////////////overdue_ind
    sal+=","                           ////////////overdue_arr_date
    sal+=","                           ////////////overdue_num_of_acc_in_area
    sal+=","                           ////////////amt_in_area
    sal+=","                           ////////////amt_in_area_crr_cd
    sal+=","                           ////////////renegotiated_ind
    sal+=","                           ////////////arr_org_cont_mat_dt
    sal+=","                           ////////////regen_arr_dt
    sal+=","                           ////////////reconst_arr_indt
    sal+=","                           ////////////fixed_term_ind
    sal+=","                           ////////////fxd_term_mat_dt
    sal+=","                           ////////////original_cont_term_arr_num
    sal+=","                           ////////////original_cont_term_uom_cd
    sal+=","                           ////////////early_red_rapaymt_prl_amt
    sal+=","                           ////////////early_red_rapaymt_prl_amt_crr_cd
    sal+=","                           ////////////pay_on_demand_ind
    sal+=","                           ////////////notice_per_num
    sal+=","                           ////////////notice_per_cd
    sal+=","                           ////////////installment_ind
    sal+=","                           ////////////instalment_paymt_schedl_indicator
    sal+=","                           ////////////first_recc_instalment_paymt_dt
    sal+=","                           ////////////final_recc_instalment_paymt_dt
    sal+=","                           ////////////prevs_instalment_paymt_dt
    sal+=","                           ////////////next_instalment_paymt_dt
    sal+=","                           ////////////inst_num_of_uom_unit
    sal+=","                           ////////////inst_paymt_uom_cd
    sal+=","                           ////////////inst_paymt_amount
    sal+=","                           ////////////crnt_inst_paymt_amt_crr_cd
    sal+=","                           ////////////inst_paymt_min_per
    sal+=","                           ////////////inst_paymt_cal_method_cd
    sal+=","                           ////////////inst_paymt_timming_cd
    sal+=","                           ////////////inst_paymt_baloon_indt
    sal+=","                           ////////////var_inst_arr_indt
    sal+=","                           ////////////inst_paymt_change_schdl_indt
    sal+=","                           ////////////indct_paymt_change_life_cap_rt
    sal+=","                           ////////////indct_paymt_change_life_cap_rt_exp_dt
    sal+=","                           ////////////indct_paymt_change_life_floor_rt
    sal+=","                           ////////////indct_paymt_change_life_floor_rt_exp_dt
    sal+=","                           ////////////first_recc_paymt_change_dt
    sal+=","                           ////////////final_recc_paymt_change_dt
    sal+=","                           ////////////next_recc_paymt_change_dt
    sal+=","                           ////////////prvs_recc_paymt_change_dt
    sal+=","                           ////////////paymt_change_num_of_units
    sal+=","                           ////////////paymt_change_uom_cd
    sal+=","                           ////////////paymt_percentage_change_life_cap_rt
    sal+=","                           ////////////paymt_percentage_change_fl_cap_rt
    sal+=","                           ////////////paymt_change_prd_per_cap_rt
    sal+=","                           ////////////paymt_change_prd_per_flr_rt
    sal+=","                           ////////////src_fund_ind
    sal+=","                           ////////////fund_rt_indtsrc_sys_cd
    sal+=","                           ////////////fund_rt_effective_dt
    sal+=","                           ////////////funding_ref_num
    sal+=","                           ////////////current_funding_rt
    sal+=","                           ////////////funding_accural_basic_cd
    sal+=","                           ////////////rollover_ind
    sal+=","                           ////////////prvs_rollover_dt
    sal+=","                           ////////////next_rollover_dt
    sal+=","                           ////////////first_funding_amt
    sal+=","                           ////////////first_funding_amt_crr_cd
    sal+=","+source_event.getString("residence_country_cd")                           ////////////country_altimate_risk_cd
    sal+=","                           ////////////trade_ind
    sal+=","                           ////////////strct_trade_arr_indt
    sal+=","                           ////////////strct_trade_drived_cd
    sal+=","                           ////////////strct_trade_drived_acc_national_cd
    sal+=","                           ////////////hyrd_strct_trade_drived_arr_indt
    sal+=","                           ////////////trade_component_ind
    sal+=","                           ////////////lead_trade_arr_indt
    sal+=","                           ////////////netting_component_ind
    sal+=","                           ////////////red_linking_acc_type
    sal+=","                           ////////////red_linking_grp_cd
    sal+=","                           ////////////legal_right_set_of_indt
    sal+=","                           ////////////agg_agr_ind
    sal+=","                           ////////////agg_arr_count
    sal+=","+source_event.getString("ip_rec_id")                           ////////////ip_local_ref_num
    sal+=","+source_event.getString("residence_country_cd")                           ////////////ip_src_sys_cd
    sal+=","+source_event.getString("prod_cd")                           ////////////product_chf

    
    record.setSal(sal);


    ///////////////
    //creating Involved Party record




    ip=source_event.getString("ip_rec_id");                            //////////////ip_rec_id
    ip+=","+record.getPpd();                            //////////////eff_dt
    ip+=",SVYAM";                            //////////////src_trace_key
    ip+=","+source_event.getString("org_unit_cd");                            //////////////org_unit_cd
    ip+=","+source_event.getString("name");                            //////////////ip_name
    ip+=","+source_event.getString("city");                            //////////////ip_city_name
    ip+=","+source_event.getString("country");                            //////////////ip_country
    ip+=","+source_event.getString("zip");                            //////////////zip_cd
    ip+=","+source_event.getString("residence_country_cd");                            //////////////ip_residence_cd
    ip+=","+source_event.getString("cust_industry_cd");                            //////////////ip_cust_type_cd
    ip+=","+source_event.getString("dtl_cust_industry_cd");                            //////////////ip_dtl_cust_type_cd
    ip+=","+source_event.getString("occupation");                            //////////////occupation


    record.setInvolvedParty(ip);
    


    ////////////////////////////
    /////Creating standard event



    event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
    event_record+=","+record.getEventCode();                            ////////////event_cd
    event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
    event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
    event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
    event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
    event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
    event_record+=","+source_event.getString("name");                            ////////////name
    event_record+=","+source_event.getString("city")+"-"+source_event.getString("zip");                            ////////////address
    event_record+=","+source_event.getString("country");                            ////////////country
    event_record+=",";                            ////////////other_dtl
    event_record+=","+source_event.getString("starting_amount");                            ////////////amount
    event_record+=","                            ////////////quantity
    event_record+=","+record.getPpd();                            ////////////event_dt
    

    record.setEventRecord(event_record);

 
    

end




//////////////////////////////////
/////////////////////////////////Contract with vendor rule for ent_cd


rule "$##$svayam$##$-510101020-CONTRACT WITH VENDOR"

when
    record:Records(record.getRuleCode()=="$##$svayam$##$_510101020_contract_with_vendor")
then
    

    /////////////
    //obtaining source event

    source_event=record.getSourceEvent();                             ///////////source_event is a json object

    
    ///////////////
    //creating arrangement record

    sal=source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf")           ////////arr_id
    sal+=","+source_event.getString("arr_src_cd")                                       /////////////arr_src_cd
    sal+=","+source_event.getString("arr_num")                                       /////////////arr_num
    sal+=","+source_event.getString("arr_suf")                                       /////////////arr_suf
    sal+=","+$##$svayam$##$getArrangementExtensionCode()                                       /////////////arr_ext_code
    sal+=","+source_event.getString("date")                                       /////////////edt
    sal+=","+record.getPpd()                                       /////////////wod
    sal+=","+record.getPpd()                                       /////////////ppd
    sal+=",SVYAM"                                               /////////////ppd
    sal+=","+source_event.getString("org_unit_cd")                                       /////////////org_unit_cd
    sal+=","+source_event.getString("date")                                       /////////////active_dt
    sal+=","                                                                /////////////inactive_dt
    sal+=","                                                                /////////////arr_src_internal_num
    sal+=","                                                                /////////////primary_ind
    
    sal+=",ACT"                                                                /////////////status_cd
    sal+=","                                                                /////////////isda_cd
    sal+=","                                                                /////////////acct_treatment_cd
    sal+=","                                                                /////////////orig_chnl_cd
    sal+=","                                                                /////////////booking_alt_org_unit_cd
    sal+=","+source_event.getString("dtl_prod_cd")                                                                /////////////dtl_prod_cd
    sal+=","                           ////////////interest_bearing_ind
    sal+=","                           ////////////int_only_ind
    sal+=","                           ////////////int_pay_schdl_ind
    sal+=","                           ////////////int_pay_dt_first
    sal+=","                           ////////////int_pay_dt_prev
    sal+=","                           ////////////int_pay_dt_next
    sal+=","                           ////////////int_pay_dt_final
    sal+=","                           ////////////int_pay_amt_cur
    sal+=","                           ////////////int_pay_curr_cd
    sal+=","                           ////////////int_pay_stub_date_start
    sal+=","                           ////////////int_pay_stub_date_end
    sal+=","                           ////////////int_pay_stub_type_cd
    sal+=","                           ////////////int_pay_unit_num
    sal+=","                           ////////////int_pay_unit_cd
    sal+=","                           ////////////int_pay_time_cd
    sal+=","                           ////////////int_rate_sched_ind
    sal+=","                           ////////////crnt_grs_int_rt
    sal+=","                           ////////////svcing_margin_rate
    sal+=","                           ////////////net_margin_rate
    sal+=","                           ////////////net_int_rate
    sal+=","                           ////////////var_rate_ind
    sal+=","                           ////////////inductory_inst_rate
    sal+=","                           ////////////indctry_inst_rate_ex_date
    sal+=","                           ////////////grs_inst_rt_rep_schdl_indt
    sal+=","                           ////////////grs_inst_fst_recc_rep_dt
    sal+=","                           ////////////grs_inst_final_rec_rep_dt
    sal+=","                           ////////////grs_inst_prvs_rec_rep_dt
    sal+=","                           ////////////grs_inst_nxt_rec_rep_dt
    sal+=","                           ////////////grs_inst_rep_prd_num_of_unit
    sal+=","                           ////////////grs_inst_rate_rep_uom_code
    sal+=","                           ////////////rep_ref_rt_crr_cd
    sal+=","                           ////////////rep_ref_rt_trm_num_of_unit
    sal+=","                           ////////////rep_ref_rt_trm_uom_cd
    sal+=","                           ////////////rep_ref_rt_curr_cd
    sal+=","                           ////////////grs_inst_rt_rep_sprd_rt
    sal+=","                           ////////////grs_inst_rt_indc_rep_sprd_rt
    sal+=","                           ////////////grs_inst_rt__indc_rep_sprd_rt_ex_dt
    sal+=","                           ////////////cap_rt_schdl_indt
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_cap_rt
    sal+=","                           ////////////grs_inst_rt_ind_abs_cap_rt
    sal+=","                           ////////////grs_inst_rt_ind_abs_cap_rt_ex_dt
    sal+=","                           ////////////floor_rt_schdl_indt
    sal+=","                           ////////////grs_inst_rt_abs_floor_rt_rep_life_floor_rt
    sal+=","                           ////////////grs_inst_indt_abs_floor_rt
    sal+=","                           ////////////grs_inst_indt_abs_floor_rt_ex_dt
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_cap_rt1
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_floor_rt
    sal+=","                           ////////////int_compound_num
    sal+=","                           ////////////int_compound_unit
    sal+=","                           ////////////int_accrual_cd
    sal+=","                           ////////////orig_int_rate
    sal+=","                           ////////////int_rate_type_cd
    sal+=","                           ////////////non_accrual_ind
    sal+=","                           ////////////overdue_ind
    sal+=","                           ////////////overdue_arr_date
    sal+=","                           ////////////overdue_num_of_acc_in_area
    sal+=","                           ////////////amt_in_area
    sal+=","                           ////////////amt_in_area_crr_cd
    sal+=","                           ////////////renegotiated_ind
    sal+=","                           ////////////arr_org_cont_mat_dt
    sal+=","                           ////////////regen_arr_dt
    sal+=","                           ////////////reconst_arr_indt
    sal+=","                           ////////////fixed_term_ind
    sal+=","                           ////////////fxd_term_mat_dt
    sal+=","                           ////////////original_cont_term_arr_num
    sal+=","                           ////////////original_cont_term_uom_cd
    sal+=","                           ////////////early_red_rapaymt_prl_amt
    sal+=","                           ////////////early_red_rapaymt_prl_amt_crr_cd
    sal+=","                           ////////////pay_on_demand_ind
    sal+=","                           ////////////notice_per_num
    sal+=","                           ////////////notice_per_cd
    sal+=","                           ////////////installment_ind
    sal+=","                           ////////////instalment_paymt_schedl_indicator
    sal+=","                           ////////////first_recc_instalment_paymt_dt
    sal+=","                           ////////////final_recc_instalment_paymt_dt
    sal+=","                           ////////////prevs_instalment_paymt_dt
    sal+=","                           ////////////next_instalment_paymt_dt
    sal+=","                           ////////////inst_num_of_uom_unit
    sal+=","                           ////////////inst_paymt_uom_cd
    sal+=","                           ////////////inst_paymt_amount
    sal+=","                           ////////////crnt_inst_paymt_amt_crr_cd
    sal+=","                           ////////////inst_paymt_min_per
    sal+=","                           ////////////inst_paymt_cal_method_cd
    sal+=","                           ////////////inst_paymt_timming_cd
    sal+=","                           ////////////inst_paymt_baloon_indt
    sal+=","                           ////////////var_inst_arr_indt
    sal+=","                           ////////////inst_paymt_change_schdl_indt
    sal+=","                           ////////////indct_paymt_change_life_cap_rt
    sal+=","                           ////////////indct_paymt_change_life_cap_rt_exp_dt
    sal+=","                           ////////////indct_paymt_change_life_floor_rt
    sal+=","                           ////////////indct_paymt_change_life_floor_rt_exp_dt
    sal+=","                           ////////////first_recc_paymt_change_dt
    sal+=","                           ////////////final_recc_paymt_change_dt
    sal+=","                           ////////////next_recc_paymt_change_dt
    sal+=","                           ////////////prvs_recc_paymt_change_dt
    sal+=","                           ////////////paymt_change_num_of_units
    sal+=","                           ////////////paymt_change_uom_cd
    sal+=","                           ////////////paymt_percentage_change_life_cap_rt
    sal+=","                           ////////////paymt_percentage_change_fl_cap_rt
    sal+=","                           ////////////paymt_change_prd_per_cap_rt
    sal+=","                           ////////////paymt_change_prd_per_flr_rt
    sal+=","                           ////////////src_fund_ind
    sal+=","                           ////////////fund_rt_indtsrc_sys_cd
    sal+=","                           ////////////fund_rt_effective_dt
    sal+=","                           ////////////funding_ref_num
    sal+=","                           ////////////current_funding_rt
    sal+=","                           ////////////funding_accural_basic_cd
    sal+=","                           ////////////rollover_ind
    sal+=","                           ////////////prvs_rollover_dt
    sal+=","                           ////////////next_rollover_dt
    sal+=","                           ////////////first_funding_amt
    sal+=","                           ////////////first_funding_amt_crr_cd
    sal+=","+source_event.getString("residence_country_cd")                           ////////////country_altimate_risk_cd
    sal+=","                           ////////////trade_ind
    sal+=","                           ////////////strct_trade_arr_indt
    sal+=","                           ////////////strct_trade_drived_cd
    sal+=","                           ////////////strct_trade_drived_acc_national_cd
    sal+=","                           ////////////hyrd_strct_trade_drived_arr_indt
    sal+=","                           ////////////trade_component_ind
    sal+=","                           ////////////lead_trade_arr_indt
    sal+=","                           ////////////netting_component_ind
    sal+=","                           ////////////red_linking_acc_type
    sal+=","                           ////////////red_linking_grp_cd
    sal+=","                           ////////////legal_right_set_of_indt
    sal+=","                           ////////////agg_agr_ind
    sal+=","                           ////////////agg_arr_count
    sal+=","+source_event.getString("ip_rec_id")                           ////////////ip_local_ref_num
    sal+=","+source_event.getString("residence_country_cd")                           ////////////ip_src_sys_cd
    sal+=","+source_event.getString("prod_cd")                           ////////////product_chf

    
    record.setSal(sal);


    ///////////////
    //creating Involved Party record



    ip=source_event.getString("ip_rec_id");                            //////////////ip_rec_id
    ip+=","+record.getPpd();                            //////////////eff_dt
    ip+=",SVYAM";                            //////////////src_trace_key
    ip+=","+source_event.getString("org_unit_cd");                            //////////////org_unit_cd
    ip+=","+source_event.getString("name");                            //////////////ip_name
    ip+=","+source_event.getString("city");                            //////////////ip_city_name
    ip+=","+source_event.getString("country");                            //////////////ip_country
    ip+=","+source_event.getString("zip");                            //////////////zip_cd
    ip+=","+source_event.getString("residence_country_cd");                            //////////////ip_residence_cd
    ip+=","+source_event.getString("cust_industry_cd");                            //////////////ip_cust_type_cd
    ip+=","+source_event.getString("dtl_cust_industry_cd");                            //////////////ip_dtl_cust_type_cd
    ip+=","+source_event.getString("occupation");                            //////////////occupation


    record.setInvolvedParty(ip);
    


    ////////////////////////////
    /////Creating standard event



    event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
    event_record+=","+record.getEventCode();                            ////////////event_cd
    event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
    event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
    event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
    event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
    event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
    event_record+=","+source_event.getString("name");                            ////////////name
    event_record+=","+source_event.getString("city")+"-"+source_event.getString("zip");                            ////////////address
    event_record+=","+source_event.getString("country");                            ////////////country
    event_record+=",";                            ////////////other_dtl
    event_record+=","+source_event.getString("starting_amount");                            ////////////amount
    event_record+=","                            ////////////quantity
    event_record+=","+record.getPpd();                            ////////////event_dt
    

    record.setEventRecord(event_record);

 
    

end




//////////////////////////////////
/////////////////////////////////Start Account rule for ent_cd


rule "$##$svayam$##$-210105050-START ACCOUNT"

when
    record:Records(record.getRuleCode()=="$##$svayam$##$_210105050_start_account")
then
    

    /////////////
    //obtaining source event

    source_event=record.getSourceEvent();                             ///////////source_event is a json object

    
    ///////////////
    //creating arrangement record

    sal=source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf")           ////////arr_id
    sal+=","+source_event.getString("arr_src_cd")                                       /////////////arr_src_cd
    sal+=","+source_event.getString("arr_num")                                       /////////////arr_num
    sal+=","+source_event.getString("arr_suf")                                       /////////////arr_suf
    sal+=","+$##$svayam$##$getArrangementExtensionCode()                                       /////////////arr_ext_code
    sal+=","+source_event.getString("date")                                       /////////////edt
    sal+=","+record.getPpd()                                       /////////////wod
    sal+=","+record.getPpd()                                       /////////////ppd
    sal+=",SVYAM"                                               /////////////ppd
    sal+=","+source_event.getString("org_unit_cd")                                       /////////////org_unit_cd
    sal+=","+source_event.getString("date")                                       /////////////active_dt
    sal+=","                                                                /////////////inactive_dt
    sal+=","                                                                /////////////arr_src_internal_num
    sal+=","                                                                /////////////primary_ind
    
    sal+=",ACT"                                                                /////////////status_cd
    sal+=","                                                                /////////////isda_cd
    sal+=","                                                                /////////////acct_treatment_cd
    sal+=","                                                                /////////////orig_chnl_cd
    sal+=","                                                                /////////////booking_alt_org_unit_cd
    sal+=","+source_event.getString("dtl_prod_cd")                                                                /////////////dtl_prod_cd
    sal+=","                           ////////////interest_bearing_ind
    sal+=","                           ////////////int_only_ind
    sal+=","                           ////////////int_pay_schdl_ind
    sal+=","                           ////////////int_pay_dt_first
    sal+=","                           ////////////int_pay_dt_prev
    sal+=","                           ////////////int_pay_dt_next
    sal+=","                           ////////////int_pay_dt_final
    sal+=","                           ////////////int_pay_amt_cur
    sal+=","                           ////////////int_pay_curr_cd
    sal+=","                           ////////////int_pay_stub_date_start
    sal+=","                           ////////////int_pay_stub_date_end
    sal+=","                           ////////////int_pay_stub_type_cd
    sal+=","                           ////////////int_pay_unit_num
    sal+=","                           ////////////int_pay_unit_cd
    sal+=","                           ////////////int_pay_time_cd
    sal+=","                           ////////////int_rate_sched_ind
    sal+=","                           ////////////crnt_grs_int_rt
    sal+=","                           ////////////svcing_margin_rate
    sal+=","                           ////////////net_margin_rate
    sal+=","                           ////////////net_int_rate
    sal+=","                           ////////////var_rate_ind
    sal+=","                           ////////////inductory_inst_rate
    sal+=","                           ////////////indctry_inst_rate_ex_date
    sal+=","                           ////////////grs_inst_rt_rep_schdl_indt
    sal+=","                           ////////////grs_inst_fst_recc_rep_dt
    sal+=","                           ////////////grs_inst_final_rec_rep_dt
    sal+=","                           ////////////grs_inst_prvs_rec_rep_dt
    sal+=","                           ////////////grs_inst_nxt_rec_rep_dt
    sal+=","                           ////////////grs_inst_rep_prd_num_of_unit
    sal+=","                           ////////////grs_inst_rate_rep_uom_code
    sal+=","                           ////////////rep_ref_rt_crr_cd
    sal+=","                           ////////////rep_ref_rt_trm_num_of_unit
    sal+=","                           ////////////rep_ref_rt_trm_uom_cd
    sal+=","                           ////////////rep_ref_rt_curr_cd
    sal+=","                           ////////////grs_inst_rt_rep_sprd_rt
    sal+=","                           ////////////grs_inst_rt_indc_rep_sprd_rt
    sal+=","                           ////////////grs_inst_rt__indc_rep_sprd_rt_ex_dt
    sal+=","                           ////////////cap_rt_schdl_indt
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_cap_rt
    sal+=","                           ////////////grs_inst_rt_ind_abs_cap_rt
    sal+=","                           ////////////grs_inst_rt_ind_abs_cap_rt_ex_dt
    sal+=","                           ////////////floor_rt_schdl_indt
    sal+=","                           ////////////grs_inst_rt_abs_floor_rt_rep_life_floor_rt
    sal+=","                           ////////////grs_inst_indt_abs_floor_rt
    sal+=","                           ////////////grs_inst_indt_abs_floor_rt_ex_dt
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_cap_rt1
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_floor_rt
    sal+=","                           ////////////int_compound_num
    sal+=","                           ////////////int_compound_unit
    sal+=","                           ////////////int_accrual_cd
    sal+=","                           ////////////orig_int_rate
    sal+=","                           ////////////int_rate_type_cd
    sal+=","                           ////////////non_accrual_ind
    sal+=","                           ////////////overdue_ind
    sal+=","                           ////////////overdue_arr_date
    sal+=","                           ////////////overdue_num_of_acc_in_area
    sal+=","                           ////////////amt_in_area
    sal+=","                           ////////////amt_in_area_crr_cd
    sal+=","                           ////////////renegotiated_ind
    sal+=","                           ////////////arr_org_cont_mat_dt
    sal+=","                           ////////////regen_arr_dt
    sal+=","                           ////////////reconst_arr_indt
    sal+=","                           ////////////fixed_term_ind
    sal+=","                           ////////////fxd_term_mat_dt
    sal+=","                           ////////////original_cont_term_arr_num
    sal+=","                           ////////////original_cont_term_uom_cd
    sal+=","                           ////////////early_red_rapaymt_prl_amt
    sal+=","                           ////////////early_red_rapaymt_prl_amt_crr_cd
    sal+=","                           ////////////pay_on_demand_ind
    sal+=","                           ////////////notice_per_num
    sal+=","                           ////////////notice_per_cd
    sal+=","                           ////////////installment_ind
    sal+=","                           ////////////instalment_paymt_schedl_indicator
    sal+=","                           ////////////first_recc_instalment_paymt_dt
    sal+=","                           ////////////final_recc_instalment_paymt_dt
    sal+=","                           ////////////prevs_instalment_paymt_dt
    sal+=","                           ////////////next_instalment_paymt_dt
    sal+=","                           ////////////inst_num_of_uom_unit
    sal+=","                           ////////////inst_paymt_uom_cd
    sal+=","                           ////////////inst_paymt_amount
    sal+=","                           ////////////crnt_inst_paymt_amt_crr_cd
    sal+=","                           ////////////inst_paymt_min_per
    sal+=","                           ////////////inst_paymt_cal_method_cd
    sal+=","                           ////////////inst_paymt_timming_cd
    sal+=","                           ////////////inst_paymt_baloon_indt
    sal+=","                           ////////////var_inst_arr_indt
    sal+=","                           ////////////inst_paymt_change_schdl_indt
    sal+=","                           ////////////indct_paymt_change_life_cap_rt
    sal+=","                           ////////////indct_paymt_change_life_cap_rt_exp_dt
    sal+=","                           ////////////indct_paymt_change_life_floor_rt
    sal+=","                           ////////////indct_paymt_change_life_floor_rt_exp_dt
    sal+=","                           ////////////first_recc_paymt_change_dt
    sal+=","                           ////////////final_recc_paymt_change_dt
    sal+=","                           ////////////next_recc_paymt_change_dt
    sal+=","                           ////////////prvs_recc_paymt_change_dt
    sal+=","                           ////////////paymt_change_num_of_units
    sal+=","                           ////////////paymt_change_uom_cd
    sal+=","                           ////////////paymt_percentage_change_life_cap_rt
    sal+=","                           ////////////paymt_percentage_change_fl_cap_rt
    sal+=","                           ////////////paymt_change_prd_per_cap_rt
    sal+=","                           ////////////paymt_change_prd_per_flr_rt
    sal+=","                           ////////////src_fund_ind
    sal+=","                           ////////////fund_rt_indtsrc_sys_cd
    sal+=","                           ////////////fund_rt_effective_dt
    sal+=","                           ////////////funding_ref_num
    sal+=","                           ////////////current_funding_rt
    sal+=","                           ////////////funding_accural_basic_cd
    sal+=","                           ////////////rollover_ind
    sal+=","                           ////////////prvs_rollover_dt
    sal+=","                           ////////////next_rollover_dt
    sal+=","                           ////////////first_funding_amt
    sal+=","                           ////////////first_funding_amt_crr_cd
    sal+=","+source_event.getString("residence_country_cd")                           ////////////country_altimate_risk_cd
    sal+=","                           ////////////trade_ind
    sal+=","                           ////////////strct_trade_arr_indt
    sal+=","                           ////////////strct_trade_drived_cd
    sal+=","                           ////////////strct_trade_drived_acc_national_cd
    sal+=","                           ////////////hyrd_strct_trade_drived_arr_indt
    sal+=","                           ////////////trade_component_ind
    sal+=","                           ////////////lead_trade_arr_indt
    sal+=","                           ////////////netting_component_ind
    sal+=","                           ////////////red_linking_acc_type
    sal+=","                           ////////////red_linking_grp_cd
    sal+=","                           ////////////legal_right_set_of_indt
    sal+=","                           ////////////agg_agr_ind
    sal+=","                           ////////////agg_arr_count
    sal+=","+source_event.getString("ip_rec_id")                           ////////////ip_local_ref_num
    sal+=","+source_event.getString("residence_country_cd")                           ////////////ip_src_sys_cd
    sal+=","+source_event.getString("prod_cd")                           ////////////product_chf

    
    record.setSal(sal);


    ///////////////
    //creating Involved Party record



    ip=source_event.getString("ip_rec_id");                            //////////////ip_rec_id
    ip+=","+record.getPpd();                            //////////////eff_dt
    ip+=",SVYAM";                            //////////////src_trace_key
    ip+=","+source_event.getString("org_unit_cd");                            //////////////org_unit_cd
    ip+=","+source_event.getString("name");                            //////////////ip_name
    ip+=","+source_event.getString("city");                            //////////////ip_city_name
    ip+=","+source_event.getString("country");                            //////////////ip_country
    ip+=","+source_event.getString("zip");                            //////////////zip_cd
    ip+=","+source_event.getString("residence_country_cd");                            //////////////ip_residence_cd
    ip+=","+source_event.getString("cust_industry_cd");                            //////////////ip_cust_type_cd
    ip+=","+source_event.getString("dtl_cust_industry_cd");                            //////////////ip_dtl_cust_type_cd
    ip+=","+source_event.getString("occupation");                            //////////////occupation


    record.setInvolvedParty(ip);
    


    ////////////////////////////
    /////Creating standard event



    event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
    event_record+=","+record.getEventCode();                            ////////////event_cd
    event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
    event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
    event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
    event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
    event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
    event_record+=","+source_event.getString("name");                            ////////////name
    event_record+=","+source_event.getString("city")+"-"+source_event.getString("zip");                            ////////////address
    event_record+=","+source_event.getString("country");                            ////////////country
    event_record+=",";                            ////////////other_dtl
    event_record+=","+source_event.getString("starting_amount");                            ////////////amount
    event_record+=","                            ////////////quantity
    event_record+=","+record.getPpd();                            ////////////event_dt
    

    record.setEventRecord(event_record);

 
    

end



//////////////////////////////////
/////////////////////////////////Issue Credit Card rule for ent_cd


rule "$##$svayam$##$-210101010-ISSUE CREDIT CARD"

when
    record:Records(record.getRuleCode()=="$##$svayam$##$_210101010_issue_credit_card")
then
    

    /////////////
    //obtaining source event

    source_event=record.getSourceEvent();                             ///////////source_event is a json object

    
    ///////////////
    //creating arrangement record

    sal=source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf")           ////////arr_id
    sal+=","+source_event.getString("arr_src_cd")                                       /////////////arr_src_cd
    sal+=","+source_event.getString("arr_num")                                       /////////////arr_num
    sal+=","+source_event.getString("arr_suf")                                       /////////////arr_suf
    sal+=","+$##$svayam$##$getArrangementExtensionCode()                                       /////////////arr_ext_code
    sal+=","+source_event.getString("date")                                       /////////////edt
    sal+=","+record.getPpd()                                       /////////////wod
    sal+=","+record.getPpd()                                       /////////////ppd
    sal+=",SVYAM"                                               /////////////ppd
    sal+=","+source_event.getString("org_unit_cd")                                       /////////////org_unit_cd
    sal+=","+source_event.getString("date")                                       /////////////active_dt
    sal+=","                                                                /////////////inactive_dt
    sal+=","                                                                /////////////arr_src_internal_num
    sal+=","                                                                /////////////primary_ind
    
    sal+=",ACT"                                                                /////////////status_cd
    sal+=","                                                                /////////////isda_cd
    sal+=","                                                                /////////////acct_treatment_cd
    sal+=","                                                                /////////////orig_chnl_cd
    sal+=","                                                                /////////////booking_alt_org_unit_cd
    sal+=","+source_event.getString("dtl_prod_cd")                                                                /////////////dtl_prod_cd
    sal+=","                           ////////////interest_bearing_ind
    sal+=","                           ////////////int_only_ind
    sal+=","                           ////////////int_pay_schdl_ind
    sal+=","                           ////////////int_pay_dt_first
    sal+=","                           ////////////int_pay_dt_prev
    sal+=","                           ////////////int_pay_dt_next
    sal+=","                           ////////////int_pay_dt_final
    sal+=","                           ////////////int_pay_amt_cur
    sal+=","                           ////////////int_pay_curr_cd
    sal+=","                           ////////////int_pay_stub_date_start
    sal+=","                           ////////////int_pay_stub_date_end
    sal+=","                           ////////////int_pay_stub_type_cd
    sal+=","                           ////////////int_pay_unit_num
    sal+=","                           ////////////int_pay_unit_cd
    sal+=","                           ////////////int_pay_time_cd
    sal+=","                           ////////////int_rate_sched_ind
    sal+=","                           ////////////crnt_grs_int_rt
    sal+=","                           ////////////svcing_margin_rate
    sal+=","                           ////////////net_margin_rate
    sal+=","                           ////////////net_int_rate
    sal+=","                           ////////////var_rate_ind
    sal+=","                           ////////////inductory_inst_rate
    sal+=","                           ////////////indctry_inst_rate_ex_date
    sal+=","                           ////////////grs_inst_rt_rep_schdl_indt
    sal+=","                           ////////////grs_inst_fst_recc_rep_dt
    sal+=","                           ////////////grs_inst_final_rec_rep_dt
    sal+=","                           ////////////grs_inst_prvs_rec_rep_dt
    sal+=","                           ////////////grs_inst_nxt_rec_rep_dt
    sal+=","                           ////////////grs_inst_rep_prd_num_of_unit
    sal+=","                           ////////////grs_inst_rate_rep_uom_code
    sal+=","                           ////////////rep_ref_rt_crr_cd
    sal+=","                           ////////////rep_ref_rt_trm_num_of_unit
    sal+=","                           ////////////rep_ref_rt_trm_uom_cd
    sal+=","                           ////////////rep_ref_rt_curr_cd
    sal+=","                           ////////////grs_inst_rt_rep_sprd_rt
    sal+=","                           ////////////grs_inst_rt_indc_rep_sprd_rt
    sal+=","                           ////////////grs_inst_rt__indc_rep_sprd_rt_ex_dt
    sal+=","                           ////////////cap_rt_schdl_indt
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_cap_rt
    sal+=","                           ////////////grs_inst_rt_ind_abs_cap_rt
    sal+=","                           ////////////grs_inst_rt_ind_abs_cap_rt_ex_dt
    sal+=","                           ////////////floor_rt_schdl_indt
    sal+=","                           ////////////grs_inst_rt_abs_floor_rt_rep_life_floor_rt
    sal+=","                           ////////////grs_inst_indt_abs_floor_rt
    sal+=","                           ////////////grs_inst_indt_abs_floor_rt_ex_dt
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_cap_rt1
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_floor_rt
    sal+=","                           ////////////int_compound_num
    sal+=","                           ////////////int_compound_unit
    sal+=","                           ////////////int_accrual_cd
    sal+=","                           ////////////orig_int_rate
    sal+=","                           ////////////int_rate_type_cd
    sal+=","                           ////////////non_accrual_ind
    sal+=","                           ////////////overdue_ind
    sal+=","                           ////////////overdue_arr_date
    sal+=","                           ////////////overdue_num_of_acc_in_area
    sal+=","                           ////////////amt_in_area
    sal+=","                           ////////////amt_in_area_crr_cd
    sal+=","                           ////////////renegotiated_ind
    sal+=","                           ////////////arr_org_cont_mat_dt
    sal+=","                           ////////////regen_arr_dt
    sal+=","                           ////////////reconst_arr_indt
    sal+=","                           ////////////fixed_term_ind
    sal+=","                           ////////////fxd_term_mat_dt
    sal+=","                           ////////////original_cont_term_arr_num
    sal+=","                           ////////////original_cont_term_uom_cd
    sal+=","                           ////////////early_red_rapaymt_prl_amt
    sal+=","                           ////////////early_red_rapaymt_prl_amt_crr_cd
    sal+=","                           ////////////pay_on_demand_ind
    sal+=","                           ////////////notice_per_num
    sal+=","                           ////////////notice_per_cd
    sal+=","                           ////////////installment_ind
    sal+=","                           ////////////instalment_paymt_schedl_indicator
    sal+=","                           ////////////first_recc_instalment_paymt_dt
    sal+=","                           ////////////final_recc_instalment_paymt_dt
    sal+=","                           ////////////prevs_instalment_paymt_dt
    sal+=","                           ////////////next_instalment_paymt_dt
    sal+=","                           ////////////inst_num_of_uom_unit
    sal+=","                           ////////////inst_paymt_uom_cd
    sal+=","                           ////////////inst_paymt_amount
    sal+=","                           ////////////crnt_inst_paymt_amt_crr_cd
    sal+=","                           ////////////inst_paymt_min_per
    sal+=","                           ////////////inst_paymt_cal_method_cd
    sal+=","                           ////////////inst_paymt_timming_cd
    sal+=","                           ////////////inst_paymt_baloon_indt
    sal+=","                           ////////////var_inst_arr_indt
    sal+=","                           ////////////inst_paymt_change_schdl_indt
    sal+=","                           ////////////indct_paymt_change_life_cap_rt
    sal+=","                           ////////////indct_paymt_change_life_cap_rt_exp_dt
    sal+=","                           ////////////indct_paymt_change_life_floor_rt
    sal+=","                           ////////////indct_paymt_change_life_floor_rt_exp_dt
    sal+=","                           ////////////first_recc_paymt_change_dt
    sal+=","                           ////////////final_recc_paymt_change_dt
    sal+=","                           ////////////next_recc_paymt_change_dt
    sal+=","                           ////////////prvs_recc_paymt_change_dt
    sal+=","                           ////////////paymt_change_num_of_units
    sal+=","                           ////////////paymt_change_uom_cd
    sal+=","                           ////////////paymt_percentage_change_life_cap_rt
    sal+=","                           ////////////paymt_percentage_change_fl_cap_rt
    sal+=","                           ////////////paymt_change_prd_per_cap_rt
    sal+=","                           ////////////paymt_change_prd_per_flr_rt
    sal+=","                           ////////////src_fund_ind
    sal+=","                           ////////////fund_rt_indtsrc_sys_cd
    sal+=","                           ////////////fund_rt_effective_dt
    sal+=","                           ////////////funding_ref_num
    sal+=","                           ////////////current_funding_rt
    sal+=","                           ////////////funding_accural_basic_cd
    sal+=","                           ////////////rollover_ind
    sal+=","                           ////////////prvs_rollover_dt
    sal+=","                           ////////////next_rollover_dt
    sal+=","                           ////////////first_funding_amt
    sal+=","                           ////////////first_funding_amt_crr_cd
    sal+=","+source_event.getString("residence_country_cd")                           ////////////country_altimate_risk_cd
    sal+=","                           ////////////trade_ind
    sal+=","                           ////////////strct_trade_arr_indt
    sal+=","                           ////////////strct_trade_drived_cd
    sal+=","                           ////////////strct_trade_drived_acc_national_cd
    sal+=","                           ////////////hyrd_strct_trade_drived_arr_indt
    sal+=","                           ////////////trade_component_ind
    sal+=","                           ////////////lead_trade_arr_indt
    sal+=","                           ////////////netting_component_ind
    sal+=","                           ////////////red_linking_acc_type
    sal+=","                           ////////////red_linking_grp_cd
    sal+=","                           ////////////legal_right_set_of_indt
    sal+=","                           ////////////agg_agr_ind
    sal+=","                           ////////////agg_arr_count
    sal+=","+source_event.getString("ip_rec_id")                           ////////////ip_local_ref_num
    sal+=","+source_event.getString("residence_country_cd")                           ////////////ip_src_sys_cd
    sal+=","+source_event.getString("prod_cd")                           ////////////product_chf

    
    record.setSal(sal);


    ///////////////
    //creating Involved Party record



    ip=source_event.getString("ip_rec_id");                            //////////////ip_rec_id
    ip+=","+record.getPpd();                            //////////////eff_dt
    ip+=",SVYAM";                            //////////////src_trace_key
    ip+=","+source_event.getString("org_unit_cd");                            //////////////org_unit_cd
    ip+=","+source_event.getString("name");                            //////////////ip_name
    ip+=","+source_event.getString("city");                            //////////////ip_city_name
    ip+=","+source_event.getString("country");                            //////////////ip_country
    ip+=","+source_event.getString("zip");                            //////////////zip_cd
    ip+=","+source_event.getString("residence_country_cd");                            //////////////ip_residence_cd
    ip+=","+source_event.getString("cust_industry_cd");                            //////////////ip_cust_type_cd
    ip+=","+source_event.getString("dtl_cust_industry_cd");                            //////////////ip_dtl_cust_type_cd
    ip+=","+source_event.getString("occupation");                            //////////////occupation


    record.setInvolvedParty(ip);
    


    ////////////////////////////
    /////Creating standard event



    event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
    event_record+=","+record.getEventCode();                            ////////////event_cd
    event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
    event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
    event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
    event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
    event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
    event_record+=","+source_event.getString("name");                            ////////////name
    event_record+=","+source_event.getString("city")+"-"+source_event.getString("zip");                            ////////////address
    event_record+=","+source_event.getString("country");                            ////////////country
    event_record+=",";                            ////////////other_dtl
    event_record+=","+source_event.getString("starting_amount");                            ////////////amount
    event_record+=","                            ////////////quantity
    event_record+=","+record.getPpd();                            ////////////event_dt
    

    record.setEventRecord(event_record);

 
    

end



//////////////////////////////////
/////////////////////////////////Loan Sanction rule for ent_cd


rule "$##$svayam$##$-210101040-LOAN SANCTION"

when
    record:Records(record.getRuleCode()=="$##$svayam$##$_210101040_loan_sanction")
then
    

    /////////////
    //obtaining source event

    source_event=record.getSourceEvent();                             ///////////source_event is a json object

    
    ///////////////
    //creating arrangement record

    sal=source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf")           ////////arr_id
    sal+=","+source_event.getString("arr_src_cd")                                       /////////////arr_src_cd
    sal+=","+source_event.getString("arr_num")                                       /////////////arr_num
    sal+=","+source_event.getString("arr_suf")                                       /////////////arr_suf
    sal+=","+$##$svayam$##$getArrangementExtensionCode()                                       /////////////arr_ext_code
    sal+=","+source_event.getString("date")                                       /////////////edt
    sal+=","+record.getPpd()                                       /////////////wod
    sal+=","+record.getPpd()                                       /////////////ppd
    sal+=",SVYAM"                                               /////////////ppd
    sal+=","+source_event.getString("org_unit_cd")                                       /////////////org_unit_cd
    sal+=","+source_event.getString("date")                                       /////////////active_dt
    sal+=","                                                                /////////////inactive_dt
    sal+=","                                                                /////////////arr_src_internal_num
    sal+=","                                                                /////////////primary_ind
    
    sal+=",ACT"                                                                /////////////status_cd
    sal+=","                                                                /////////////isda_cd
    sal+=","                                                                /////////////acct_treatment_cd
    sal+=","                                                                /////////////orig_chnl_cd
    sal+=","                                                                /////////////booking_alt_org_unit_cd
    sal+=","+source_event.getString("dtl_prod_cd")                                                                /////////////dtl_prod_cd
    sal+=","                           ////////////interest_bearing_ind
    sal+=","                           ////////////int_only_ind
    sal+=","                           ////////////int_pay_schdl_ind
    sal+=","                           ////////////int_pay_dt_first
    sal+=","                           ////////////int_pay_dt_prev
    sal+=","                           ////////////int_pay_dt_next
    sal+=","                           ////////////int_pay_dt_final
    sal+=","                           ////////////int_pay_amt_cur
    sal+=","                           ////////////int_pay_curr_cd
    sal+=","                           ////////////int_pay_stub_date_start
    sal+=","                           ////////////int_pay_stub_date_end
    sal+=","                           ////////////int_pay_stub_type_cd
    sal+=","                           ////////////int_pay_unit_num
    sal+=","                           ////////////int_pay_unit_cd
    sal+=","                           ////////////int_pay_time_cd
    sal+=","                           ////////////int_rate_sched_ind
    sal+=","                           ////////////crnt_grs_int_rt
    sal+=","                           ////////////svcing_margin_rate
    sal+=","                           ////////////net_margin_rate
    sal+=","                           ////////////net_int_rate
    sal+=","                           ////////////var_rate_ind
    sal+=","                           ////////////inductory_inst_rate
    sal+=","                           ////////////indctry_inst_rate_ex_date
    sal+=","                           ////////////grs_inst_rt_rep_schdl_indt
    sal+=","                           ////////////grs_inst_fst_recc_rep_dt
    sal+=","                           ////////////grs_inst_final_rec_rep_dt
    sal+=","                           ////////////grs_inst_prvs_rec_rep_dt
    sal+=","                           ////////////grs_inst_nxt_rec_rep_dt
    sal+=","                           ////////////grs_inst_rep_prd_num_of_unit
    sal+=","                           ////////////grs_inst_rate_rep_uom_code
    sal+=","                           ////////////rep_ref_rt_crr_cd
    sal+=","                           ////////////rep_ref_rt_trm_num_of_unit
    sal+=","                           ////////////rep_ref_rt_trm_uom_cd
    sal+=","                           ////////////rep_ref_rt_curr_cd
    sal+=","                           ////////////grs_inst_rt_rep_sprd_rt
    sal+=","                           ////////////grs_inst_rt_indc_rep_sprd_rt
    sal+=","                           ////////////grs_inst_rt__indc_rep_sprd_rt_ex_dt
    sal+=","                           ////////////cap_rt_schdl_indt
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_cap_rt
    sal+=","                           ////////////grs_inst_rt_ind_abs_cap_rt
    sal+=","                           ////////////grs_inst_rt_ind_abs_cap_rt_ex_dt
    sal+=","                           ////////////floor_rt_schdl_indt
    sal+=","                           ////////////grs_inst_rt_abs_floor_rt_rep_life_floor_rt
    sal+=","                           ////////////grs_inst_indt_abs_floor_rt
    sal+=","                           ////////////grs_inst_indt_abs_floor_rt_ex_dt
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_cap_rt1
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_floor_rt
    sal+=","                           ////////////int_compound_num
    sal+=","                           ////////////int_compound_unit
    sal+=","                           ////////////int_accrual_cd
    sal+=","                           ////////////orig_int_rate
    sal+=","                           ////////////int_rate_type_cd
    sal+=","                           ////////////non_accrual_ind
    sal+=","                           ////////////overdue_ind
    sal+=","                           ////////////overdue_arr_date
    sal+=","                           ////////////overdue_num_of_acc_in_area
    sal+=","                           ////////////amt_in_area
    sal+=","                           ////////////amt_in_area_crr_cd
    sal+=","                           ////////////renegotiated_ind
    sal+=","                           ////////////arr_org_cont_mat_dt
    sal+=","                           ////////////regen_arr_dt
    sal+=","                           ////////////reconst_arr_indt
    sal+=","                           ////////////fixed_term_ind
    sal+=","                           ////////////fxd_term_mat_dt
    sal+=","                           ////////////original_cont_term_arr_num
    sal+=","                           ////////////original_cont_term_uom_cd
    sal+=","                           ////////////early_red_rapaymt_prl_amt
    sal+=","                           ////////////early_red_rapaymt_prl_amt_crr_cd
    sal+=","                           ////////////pay_on_demand_ind
    sal+=","                           ////////////notice_per_num
    sal+=","                           ////////////notice_per_cd
    sal+=","                           ////////////installment_ind
    sal+=","                           ////////////instalment_paymt_schedl_indicator
    sal+=","                           ////////////first_recc_instalment_paymt_dt
    sal+=","                           ////////////final_recc_instalment_paymt_dt
    sal+=","                           ////////////prevs_instalment_paymt_dt
    sal+=","                           ////////////next_instalment_paymt_dt
    sal+=","                           ////////////inst_num_of_uom_unit
    sal+=","                           ////////////inst_paymt_uom_cd
    sal+=","                           ////////////inst_paymt_amount
    sal+=","                           ////////////crnt_inst_paymt_amt_crr_cd
    sal+=","                           ////////////inst_paymt_min_per
    sal+=","                           ////////////inst_paymt_cal_method_cd
    sal+=","                           ////////////inst_paymt_timming_cd
    sal+=","                           ////////////inst_paymt_baloon_indt
    sal+=","                           ////////////var_inst_arr_indt
    sal+=","                           ////////////inst_paymt_change_schdl_indt
    sal+=","                           ////////////indct_paymt_change_life_cap_rt
    sal+=","                           ////////////indct_paymt_change_life_cap_rt_exp_dt
    sal+=","                           ////////////indct_paymt_change_life_floor_rt
    sal+=","                           ////////////indct_paymt_change_life_floor_rt_exp_dt
    sal+=","                           ////////////first_recc_paymt_change_dt
    sal+=","                           ////////////final_recc_paymt_change_dt
    sal+=","                           ////////////next_recc_paymt_change_dt
    sal+=","                           ////////////prvs_recc_paymt_change_dt
    sal+=","                           ////////////paymt_change_num_of_units
    sal+=","                           ////////////paymt_change_uom_cd
    sal+=","                           ////////////paymt_percentage_change_life_cap_rt
    sal+=","                           ////////////paymt_percentage_change_fl_cap_rt
    sal+=","                           ////////////paymt_change_prd_per_cap_rt
    sal+=","                           ////////////paymt_change_prd_per_flr_rt
    sal+=","                           ////////////src_fund_ind
    sal+=","                           ////////////fund_rt_indtsrc_sys_cd
    sal+=","                           ////////////fund_rt_effective_dt
    sal+=","                           ////////////funding_ref_num
    sal+=","                           ////////////current_funding_rt
    sal+=","                           ////////////funding_accural_basic_cd
    sal+=","                           ////////////rollover_ind
    sal+=","                           ////////////prvs_rollover_dt
    sal+=","                           ////////////next_rollover_dt
    sal+=","                           ////////////first_funding_amt
    sal+=","                           ////////////first_funding_amt_crr_cd
    sal+=","+source_event.getString("residence_country_cd")                           ////////////country_altimate_risk_cd
    sal+=","                           ////////////trade_ind
    sal+=","                           ////////////strct_trade_arr_indt
    sal+=","                           ////////////strct_trade_drived_cd
    sal+=","                           ////////////strct_trade_drived_acc_national_cd
    sal+=","                           ////////////hyrd_strct_trade_drived_arr_indt
    sal+=","                           ////////////trade_component_ind
    sal+=","                           ////////////lead_trade_arr_indt
    sal+=","                           ////////////netting_component_ind
    sal+=","                           ////////////red_linking_acc_type
    sal+=","                           ////////////red_linking_grp_cd
    sal+=","                           ////////////legal_right_set_of_indt
    sal+=","                           ////////////agg_agr_ind
    sal+=","                           ////////////agg_arr_count
    sal+=","+source_event.getString("ip_rec_id")                           ////////////ip_local_ref_num
    sal+=","+source_event.getString("residence_country_cd")                           ////////////ip_src_sys_cd
    sal+=","+source_event.getString("prod_cd")                           ////////////product_chf

    
    record.setSal(sal);


    ///////////////
    //creating Involved Party record




    ip=source_event.getString("ip_rec_id");                            //////////////ip_rec_id
    ip+=","+record.getPpd();                            //////////////eff_dt
    ip+=",SVYAM";                            //////////////src_trace_key
    ip+=","+source_event.getString("org_unit_cd");                            //////////////org_unit_cd
    ip+=","+source_event.getString("name");                            //////////////ip_name
    ip+=","+source_event.getString("city");                            //////////////ip_city_name
    ip+=","+source_event.getString("country");                            //////////////ip_country
    ip+=","+source_event.getString("zip");                            //////////////zip_cd
    ip+=","+source_event.getString("residence_country_cd");                            //////////////ip_residence_cd
    ip+=","+source_event.getString("cust_industry_cd");                            //////////////ip_cust_type_cd
    ip+=","+source_event.getString("dtl_cust_industry_cd");                            //////////////ip_dtl_cust_type_cd
    ip+=","+source_event.getString("occupation");                            //////////////occupation


    record.setInvolvedParty(ip);
    


    ////////////////////////////
    /////Creating standard event



    event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
    event_record+=","+record.getEventCode();                            ////////////event_cd
    event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
    event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
    event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
    event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
    event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
    event_record+=","+source_event.getString("name");                            ////////////name
    event_record+=","+source_event.getString("city")+"-"+source_event.getString("zip");                            ////////////address
    event_record+=","+source_event.getString("country");                            ////////////country
    event_record+=",";                            ////////////other_dtl
    event_record+=","+source_event.getString("starting_amount");                            ////////////amount
    event_record+=","                            ////////////quantity
    event_record+=","+record.getPpd();                            ////////////event_dt
    

    record.setEventRecord(event_record);

 
    

end





//////////////////////////////////
/////////////////////////////////Apply for equity rule for ent_cd


rule "$##$svayam$##$-210201010-APPLY FOR EQUITY"

when
    record:Records(record.getRuleCode()=="$##$svayam$##$_210201010_apply_for_equity")
then
    

    /////////////
    //obtaining source event

    source_event=record.getSourceEvent();                             ///////////source_event is a json object

    
    ///////////////
    //creating arrangement record

    sal=source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf")           ////////arr_id
    sal+=","+source_event.getString("arr_src_cd")                                       /////////////arr_src_cd
    sal+=","+source_event.getString("arr_num")                                       /////////////arr_num
    sal+=","+source_event.getString("arr_suf")                                       /////////////arr_suf
    sal+=","+$##$svayam$##$getArrangementExtensionCode()                                       /////////////arr_ext_code
    sal+=","+source_event.getString("date")                                       /////////////edt
    sal+=","+record.getPpd()                                       /////////////wod
    sal+=","+record.getPpd()                                       /////////////ppd
    sal+=",SVYAM"                                               /////////////ppd
    sal+=","+source_event.getString("org_unit_cd")                                       /////////////org_unit_cd
    sal+=","+source_event.getString("date")                                       /////////////active_dt
    sal+=","                                                                /////////////inactive_dt
    sal+=","                                                                /////////////arr_src_internal_num
    sal+=","                                                                /////////////primary_ind
    
    sal+=",ACT"                                                                /////////////status_cd
    sal+=","                                                                /////////////isda_cd
    sal+=","                                                                /////////////acct_treatment_cd
    sal+=","                                                                /////////////orig_chnl_cd
    sal+=","                                                                /////////////booking_alt_org_unit_cd
    sal+=","+source_event.getString("dtl_prod_cd")                                                                /////////////dtl_prod_cd
    sal+=","                           ////////////interest_bearing_ind
    sal+=","                           ////////////int_only_ind
    sal+=","                           ////////////int_pay_schdl_ind
    sal+=","                           ////////////int_pay_dt_first
    sal+=","                           ////////////int_pay_dt_prev
    sal+=","                           ////////////int_pay_dt_next
    sal+=","                           ////////////int_pay_dt_final
    sal+=","                           ////////////int_pay_amt_cur
    sal+=","                           ////////////int_pay_curr_cd
    sal+=","                           ////////////int_pay_stub_date_start
    sal+=","                           ////////////int_pay_stub_date_end
    sal+=","                           ////////////int_pay_stub_type_cd
    sal+=","                           ////////////int_pay_unit_num
    sal+=","                           ////////////int_pay_unit_cd
    sal+=","                           ////////////int_pay_time_cd
    sal+=","                           ////////////int_rate_sched_ind
    sal+=","                           ////////////crnt_grs_int_rt
    sal+=","                           ////////////svcing_margin_rate
    sal+=","                           ////////////net_margin_rate
    sal+=","                           ////////////net_int_rate
    sal+=","                           ////////////var_rate_ind
    sal+=","                           ////////////inductory_inst_rate
    sal+=","                           ////////////indctry_inst_rate_ex_date
    sal+=","                           ////////////grs_inst_rt_rep_schdl_indt
    sal+=","                           ////////////grs_inst_fst_recc_rep_dt
    sal+=","                           ////////////grs_inst_final_rec_rep_dt
    sal+=","                           ////////////grs_inst_prvs_rec_rep_dt
    sal+=","                           ////////////grs_inst_nxt_rec_rep_dt
    sal+=","                           ////////////grs_inst_rep_prd_num_of_unit
    sal+=","                           ////////////grs_inst_rate_rep_uom_code
    sal+=","                           ////////////rep_ref_rt_crr_cd
    sal+=","                           ////////////rep_ref_rt_trm_num_of_unit
    sal+=","                           ////////////rep_ref_rt_trm_uom_cd
    sal+=","                           ////////////rep_ref_rt_curr_cd
    sal+=","                           ////////////grs_inst_rt_rep_sprd_rt
    sal+=","                           ////////////grs_inst_rt_indc_rep_sprd_rt
    sal+=","                           ////////////grs_inst_rt__indc_rep_sprd_rt_ex_dt
    sal+=","                           ////////////cap_rt_schdl_indt
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_cap_rt
    sal+=","                           ////////////grs_inst_rt_ind_abs_cap_rt
    sal+=","                           ////////////grs_inst_rt_ind_abs_cap_rt_ex_dt
    sal+=","                           ////////////floor_rt_schdl_indt
    sal+=","                           ////////////grs_inst_rt_abs_floor_rt_rep_life_floor_rt
    sal+=","                           ////////////grs_inst_indt_abs_floor_rt
    sal+=","                           ////////////grs_inst_indt_abs_floor_rt_ex_dt
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_cap_rt1
    sal+=","                           ////////////grs_inst_rt_rep_prd_abs_floor_rt
    sal+=","                           ////////////int_compound_num
    sal+=","                           ////////////int_compound_unit
    sal+=","                           ////////////int_accrual_cd
    sal+=","                           ////////////orig_int_rate
    sal+=","                           ////////////int_rate_type_cd
    sal+=","                           ////////////non_accrual_ind
    sal+=","                           ////////////overdue_ind
    sal+=","                           ////////////overdue_arr_date
    sal+=","                           ////////////overdue_num_of_acc_in_area
    sal+=","                           ////////////amt_in_area
    sal+=","                           ////////////amt_in_area_crr_cd
    sal+=","                           ////////////renegotiated_ind
    sal+=","                           ////////////arr_org_cont_mat_dt
    sal+=","                           ////////////regen_arr_dt
    sal+=","                           ////////////reconst_arr_indt
    sal+=","                           ////////////fixed_term_ind
    sal+=","                           ////////////fxd_term_mat_dt
    sal+=","                           ////////////original_cont_term_arr_num
    sal+=","                           ////////////original_cont_term_uom_cd
    sal+=","                           ////////////early_red_rapaymt_prl_amt
    sal+=","                           ////////////early_red_rapaymt_prl_amt_crr_cd
    sal+=","                           ////////////pay_on_demand_ind
    sal+=","                           ////////////notice_per_num
    sal+=","                           ////////////notice_per_cd
    sal+=","                           ////////////installment_ind
    sal+=","                           ////////////instalment_paymt_schedl_indicator
    sal+=","                           ////////////first_recc_instalment_paymt_dt
    sal+=","                           ////////////final_recc_instalment_paymt_dt
    sal+=","                           ////////////prevs_instalment_paymt_dt
    sal+=","                           ////////////next_instalment_paymt_dt
    sal+=","                           ////////////inst_num_of_uom_unit
    sal+=","                           ////////////inst_paymt_uom_cd
    sal+=","                           ////////////inst_paymt_amount
    sal+=","                           ////////////crnt_inst_paymt_amt_crr_cd
    sal+=","                           ////////////inst_paymt_min_per
    sal+=","                           ////////////inst_paymt_cal_method_cd
    sal+=","                           ////////////inst_paymt_timming_cd
    sal+=","                           ////////////inst_paymt_baloon_indt
    sal+=","                           ////////////var_inst_arr_indt
    sal+=","                           ////////////inst_paymt_change_schdl_indt
    sal+=","                           ////////////indct_paymt_change_life_cap_rt
    sal+=","                           ////////////indct_paymt_change_life_cap_rt_exp_dt
    sal+=","                           ////////////indct_paymt_change_life_floor_rt
    sal+=","                           ////////////indct_paymt_change_life_floor_rt_exp_dt
    sal+=","                           ////////////first_recc_paymt_change_dt
    sal+=","                           ////////////final_recc_paymt_change_dt
    sal+=","                           ////////////next_recc_paymt_change_dt
    sal+=","                           ////////////prvs_recc_paymt_change_dt
    sal+=","                           ////////////paymt_change_num_of_units
    sal+=","                           ////////////paymt_change_uom_cd
    sal+=","                           ////////////paymt_percentage_change_life_cap_rt
    sal+=","                           ////////////paymt_percentage_change_fl_cap_rt
    sal+=","                           ////////////paymt_change_prd_per_cap_rt
    sal+=","                           ////////////paymt_change_prd_per_flr_rt
    sal+=","                           ////////////src_fund_ind
    sal+=","                           ////////////fund_rt_indtsrc_sys_cd
    sal+=","                           ////////////fund_rt_effective_dt
    sal+=","                           ////////////funding_ref_num
    sal+=","                           ////////////current_funding_rt
    sal+=","                           ////////////funding_accural_basic_cd
    sal+=","                           ////////////rollover_ind
    sal+=","                           ////////////prvs_rollover_dt
    sal+=","                           ////////////next_rollover_dt
    sal+=","                           ////////////first_funding_amt
    sal+=","                           ////////////first_funding_amt_crr_cd
    sal+=","+source_event.getString("residence_country_cd")                           ////////////country_altimate_risk_cd
    sal+=","                           ////////////trade_ind
    sal+=","                           ////////////strct_trade_arr_indt
    sal+=","                           ////////////strct_trade_drived_cd
    sal+=","                           ////////////strct_trade_drived_acc_national_cd
    sal+=","                           ////////////hyrd_strct_trade_drived_arr_indt
    sal+=","                           ////////////trade_component_ind
    sal+=","                           ////////////lead_trade_arr_indt
    sal+=","                           ////////////netting_component_ind
    sal+=","                           ////////////red_linking_acc_type
    sal+=","                           ////////////red_linking_grp_cd
    sal+=","                           ////////////legal_right_set_of_indt
    sal+=","                           ////////////agg_agr_ind
    sal+=","                           ////////////agg_arr_count
    sal+=","+source_event.getString("ip_rec_id")                           ////////////ip_local_ref_num
    sal+=","+source_event.getString("residence_country_cd")                           ////////////ip_src_sys_cd
    sal+=","+source_event.getString("prod_cd")                           ////////////product_chf

    
    record.setSal(sal);


    ///////////////
    //creating Involved Party record



    ip=source_event.getString("ip_rec_id");                            //////////////ip_rec_id
    ip+=","+record.getPpd();                            //////////////eff_dt
    ip+=",SVYAM";                            //////////////src_trace_key
    ip+=","+source_event.getString("org_unit_cd");                            //////////////org_unit_cd
    ip+=","+source_event.getString("name");                            //////////////ip_name
    ip+=","+source_event.getString("city");                            //////////////ip_city_name
    ip+=","+source_event.getString("country");                            //////////////ip_country
    ip+=","+source_event.getString("zip");                            //////////////zip_cd
    ip+=","+source_event.getString("residence_country_cd");                            //////////////ip_residence_cd
    ip+=","+source_event.getString("cust_industry_cd");                            //////////////ip_cust_type_cd
    ip+=","+source_event.getString("dtl_cust_industry_cd");                            //////////////ip_dtl_cust_type_cd
    ip+=","+source_event.getString("occupation");                            //////////////occupation


    record.setInvolvedParty(ip);
    


    ////////////////////////////
    /////Creating standard event



    event_record=source_event.getString("org_unit_cd");                            ////////////org_unit_cd
    event_record+=","+record.getEventCode();                            ////////////event_cd
    event_record+=","+source_event.getString("prod_cd");                            ////////////prod_cd
    event_record+=","+source_event.getString("dtl_prod_cd");                            ////////////dtl_prod_cd
    event_record+=","+source_event.getString("cust_industry_cd");                            ////////////cust_industry_cd
    event_record+=","+source_event.getString("dtl_cust_industry_cd");                            ////////////dtl_cust_industry_cd
    event_record+=","+source_event.getString("arr_src_cd")+source_event.getString("arr_num")+source_event.getString("arr_suf");            ////////////arr_id
    event_record+=","+source_event.getString("name");                            ////////////name
    event_record+=","+source_event.getString("city")+"-"+source_event.getString("zip");                            ////////////address
    event_record+=","+source_event.getString("country");                            ////////////country
    event_record+=",";                            ////////////other_dtl
    event_record+=","+source_event.getString("starting_amount");                            ////////////amount
    event_record+=","                            ////////////quantity
    event_record+=","+record.getPpd();                            ////////////event_dt
    

    record.setEventRecord(event_record);

 

  

end




